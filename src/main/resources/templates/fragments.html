<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <!--ESTE HTML SOLAMENTE SIRVE PARA ALMACENAR FRAGMENTS DE THYMELEAF.-->
    <meta charset="utf-8">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Last-Modified" content="0">
    <meta http-equiv="Cache-Control" content="no-cache, mustrevalidate">
    <meta http-equiv="Pragma" content="no-cache">

    <link href="../static/css/todo.css" th:href="@{/css/todo.css}" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="../static/js/script.js" th:src="@{'/js/script.js'}"></script>

    <link href="../static/imgs/icono-2.ico" th:href="@{/imgs/icono-2.ico}" rel="shortcut icon">
</head>
<body>
<!--
    PARA INSERTAR ESTE NAV SIMPLEMENTE ESCRIBE LO SIGUIENTE DENTRO DE UNAS ETIQUETAS NAV VACIAS:
    th:replace="fragments.html :: nav"
-->
<nav th:fragment="nav">
    <img class="logo" src="/imgs/logo.jpg" th:src="@{/imgs/logo.jpg}">
    <span class="menu-item"><a href="/../venta"><b>Venta</b></a></span>
    <hr class="menu-separator" size=2 color="#FFFF66">
    <span class="menu-item" sec:authorize="hasAuthority('GERENTE')"><a href="/../alimentos/consultaAlimentos"><b>Alimentos</b></a></span>
    <span class="menu-item" sec:authorize="hasAuthority('GERENTE')"><a href="/../promociones/consultaPromociones"><b>Promociones</b></a></span>
    <!--
    <span class="menu-item" onClick="show('pr','f2')"><img class="arrow" id="f2" src="/imgs/expand-button.png" th:src="@{/imgs/expand-button.png}"><b>Promociones</b></span>
    <div class="submenu" id="pr">
        <ul>
            <li><a href="/../promociones/registrarPromocion">Registro</a></li>
            <li><a href="/../promociones/consultaPromociones">Consulta</a></li>
        </ul>
    </div>
    -->
    <span class="menu-item"><a href="/../clientes/consultaClientes"><b>Clientes</b></a></span>
    <!--
    <span class="menu-item" onClick="show('cl','f3')"><img class="arrow" id="f3" src="/imgs/expand-button.png" th:src="@{/imgs/expand-button.png}"><b>Clientes</b></span>
    <div class="submenu" id="cl">
        <ul>
            <li><a href="/../clientes/modificarCliente">Modificación</a></li>
        </ul>
    </div>
    -->
    <hr class="menu-separator" size=2 color="#FFFF66">
    <span class="menu-item"><a href="/../gasto/muestraGasto"><b>Registro de Gastos</b></a></span>
    <hr class="menu-separator" size=2 color="#FFFF66">
    <span class="menu-item"><a href="/../corteCaja/actual"><b>Corte de Caja</b></a></span>
    <span class="menu-item"><a href="/../corteCaja/historial"><b>Historial de Corte</b></a></span>
    <!--
    <span class="menu-item" onClick="show('cc','f4')"><img class="arrow" id="f4" src="/imgs/expand-button.png" th:src="@{/imgs/expand-button.png}"><b>Corte de Caja</b></span>
    <div class="submenu" id="cc">
        <ul>
            <li><a href="/../corteCaja/actual">Generar actual</a></li>
            <li><a href="/../corteCaja/historial">Consultar historial</a></li>
        </ul>
    </div>
    -->
    <hr class="menu-separator" size=2 color="#FFFF66" sec:authorize="hasAuthority('GERENTE')">
    <span class="menu-item" sec:authorize="hasAuthority('GERENTE')"><a href="/../configuracion/sistema"><b>Configuración</b></a></span>
    <span class="menu-item" sec:authorize="hasAuthority('GERENTE')"><a href="/../usuarios/consultaUsuarios"><b>Control Usuarios</b></a></span>
    <hr class="menu-separator" size=2 color="#FFFF66">
    <span class="menu-item"><a href="/../idManager/consultaCategorias"><b>Categorías</b></a></span>
    <span class="menu-item"><a href="/../idManager/consultaNombres"><b>Nombres</b></a></span>
    <span class="menu-item"><a href="/../idManager/consultaTamanos" th:href="@{/idManager/consultaTamanos}"><b>Tamaños</b></a></span>
    </div>
    <!--
    <span class="menu-item" onClick="show('co','f5')"><img class="arrow" id="f5" src="/imgs/expand-button.png" th:src="@{/imgs/expand-button.png}"><b>Configuración</b></span>
    <div class="submenu" id="co">
        <ul>
            <li><a href="/../configuracion/sistema">Sistema</a></li>
            <li><a href="/../usuarios/consultaUsuarios">Acceso</a></li>
        </ul>
    </div>
    -->
</nav>

<!--LOGIN. USUARIO Y LOGOUT-->
<div th:fragment="rol" class="rol">
    <form th:action="@{/logout}" method="post">
        Usuario: <span sec:authentication="name"></span>
        <input type="image" class="icon" src="/imgs/logout.png" th:src="@{/imgs/logout.png}" title="CERRAR SESIÓN">
    </form>
</div>

<!--CONTENIDO RECIBO. Muestra los alimentos que se van agregando-->
<aside th:fragment="contenidosRecibo">
    <table>
        <thead>
        <tr>RESUMEN DE LA ORDEN <img class="list" src="/imgs/check-list.png" th:src="@{/imgs/check-list.png}"></tr>
        <tr>
            <th>Cant</th>
            <th>Nombre</th>
            <th>Precio</th>
            <th>Total</th>
            <th></th>
        </tr>
        </thead>
        <hr size=4 color="#CCCCCC">
        <tbody>
        <tr>
            <td>2</td>
            <td>Rebanada Pepperoni</td>
            <td>40.00</td>
            <td>80.00</td>
            <td><input type="image" class="cross" src="/imgs/cancel.png" th:src="@{/imgs/cancel.png}"><td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
            <td></td>
            <td></td>
            <td>Total</td>
            <td></td>
        </tr>
        </tfoot>
    </table>
</aside>


<script>
    function updateCliente() {
        var url = '/venta/findCliente';

        if ($('#telefono').val() != '') {
            url = url + '/' + $('#telefono').val();
        }

        alert("fragments\nTel: " + $('#telefono').val() + "\nURL: " + url);

        $("#cliente").load(url);
    }
</script>
<!--CLIENTES. Busqueda y Registro-->
<form action="#" th:action="@{/venta/addCliente}" th:object="${clienteModel}" method="post" onsubmit="return validar()" th:fragment="cliente">
    Número de teléfono:
    <input id="telefono" type="number" size="20" th:field="*{telefono}" th:value="${telefono}" placeholder="1112223344" maxlength="10">
    <!--name="action" value="buscar"-->
    <button class="yellow" type="button" size="20" onclick="updateCliente()">Buscar</button>
    <div class="registrar">
        <b>¿Cliente nuevo?</b>
        <button class="yellow" type="submit" size="20" name="action" value="registrar" onclick="validar()">¡Registralo!</button>
    </div><br>
    Nombre del cliente:
    <input id="nombre" type="text" class="nom" th:field="*{nombre}" th:value="${nombre}" placeholder="Nombre(s)">
    <input id="apellido" type="text" class="app" th:field="*{apellidos}" th:value="${apellidos}" placeholder="Apellido(s)"><br>
    Dirección:
    <input id="dir" type="text" class="dir" th:field="*{direccion}" th:value="${direccion}" placeholder="Calle, Número, Colonia"><br>
    Correo:
    <input id="correo" type="text" class="dir" th:field="*{correo}" th:value="${correo}" placeholder="usuario@dominio"><br>
    Puntos:
    <input type="number" th:field="*{puntos}" th:value="${puntos}" readonly>
    RFC:
    <input id="rfc" type="text" th:field="*{RFC}" th:value="${RFC}" placeholder="XXXX000000" maxlength="15"><br>

    <!--
    <script>
        function validar() {
            var telefono, nombre, apellido, dir, correo, rfc, rfcConv;
            telefono = document.getElementById("telefono").value;
            nombre = document.getElementById("nombre").value;
            apellido = document.getElementById("apellido").value;
            dir = document.getElementById("dir").value;
            rfc = document.getElementById("rfc").value;
            rfcConv=rfc.toUpperCase();
            rfcChar= rfc.charAt(0);
            rfcChar1=rfc.charAt(1);
            rfcChar2=rfc.charAt(2);

            /*if (isDigit(rfcChar)||isDigit(rfcChar1)||isDigit(rfcChar2)){
                alert("los primero 3 caracteres deben ser letras")
               return false;
            }*/
            if(rfc!=rfcConv){
                alert("RFC debe ser en mayusculas")
                return false;
            }

            if(rfc.length>13 || rfc.length<12){
                alert("formato de RFC incorrecto")
                return false;
            }

            if (telefono!=""||nombre!=""||apellido!=""||dir!=""||correo!=""||rfc!=""||rfc.length>=12 && rfc.length<=13){
                alert("agregado exitosamente" );
                return true;
            }
        }
    </script>
    -->
</form>
</body>
</html>